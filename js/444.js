"use strict";(self.webpackChunkart_quiz=self.webpackChunkart_quiz||[]).push([[444],{620:(e,t,s)=>{s.d(t,{g:()=>a});const a=new class{async getTopics(){return this.topics||(this.topics=await(await fetch("./assets/topics.json")).json()),this.topics}async getCategoriesFor(e){return await this.getTopics(),this.topics[e].categories||(this.topics[e].categories=await(await fetch(`./assets/topics/${e}/categories.json`)).json()),this.topics[e].categories}async getItemsFor(e){return await this.getTopics(),this.topics[e].items||(this.topics[e].items=await(await fetch(`./assets/topics/${e}/items.json`)).json()),this.topics[e].items}async getRoundTemplates(){return this.roundTemplates||(this.roundTemplates=await(await fetch("./assets/round.json")).json()),this.roundTemplates}}},888:(e,t,s)=>{s.d(t,{Z:()=>a});const a=new class{constructor(){this.supportedLocales=["be","en"],this.locale="en"}setLocale(e){if(!this.supportedLocales.includes(e))throw new Error("Unsupported language tag passed");this.locale=e,document.dispatchEvent(new CustomEvent("localechange"))}getLocale(){return this.locale}}},684:(e,t,s)=>{s.d(t,{Z:()=>a});const a={replace:(e,t)=>e?Object.values(e.match(/(?<={{).*?(?=}})/g)).reduce(((e,s)=>e.replace(`{{${s}}}`,t[s])),e):""}},350:(e,t,s)=>{s.d(t,{G:()=>n});var a=s(684);class n{constructor({viewName:e,funcs:t}){if(!e||!t?.getContext)throw new Error("You must pass required arguments in View constructor");this.viewName=e,this.funcs=t}async getTemplate(){return this.template||(this.template=await(await fetch(`./views/${this.viewName}.html`)).text()),this.template}async getFormattedTemplate(e){return a.Z.replace(await this.getTemplate(),await this.runFunc("getContext",e))}runFunc(e,t){return this.funcs[e]?.apply(this,[t])}}},444:(e,t,s)=>{s.r(t),s.d(t,{view:()=>i});var a=s(350),n=s(620),r=s(684),o=s(888);const i=new a.G({viewName:"category",funcs:{async beforeLoad({parameters:e}){this.match&&0!=+e.roundInd||(this.match=await async function({topicName:e,categoryName:t}){const s=await n.g.getItemsFor(e),a=(await n.g.getCategoriesFor(e))[t],i=[];return{topic:e,category:t,rounds:[...new Array(10)].map((()=>{let e;do{e=Math.floor(Math.random()*s.length)}while(i.includes(e));i.push(e);const t=s[e],n=r.Z.replace(a.baseUrl,{itemInd:e});return{question:r.Z.replace(a.question[o.Z.getLocale()],t),questionContent:r.Z.replace(a.questionContent,{imageUrl:n}),rightAnswer:t[a.answer],answers:[...s.reduce(((e,s)=>(e.includes(s[a.answer])||s[a.answer]===t[a.answer]||(a.unique?s[a.unique]!==t[a.unique]&&e.push(s[a.answer]):e.push(s[a.answer])),e)),[]).sort((()=>Math.random()-.5)).slice(0,3),t[a.answer]].sort((()=>Math.random()-.5))}}))}}({topicName:e.topic,categoryName:e.category}))},async getContext({parameters:e}){const t=(await n.g.getCategoriesFor(e.topic))[e.category],s=await n.g.getItemsFor(e.topic),a=this.match.rounds[e.roundInd];return{question:a.question,questionContent:a.questionContent,roundInd:e.roundInd,answers:a.answers.map((e=>{const a=s.findIndex((s=>s[t.answer]===e));return r.Z.replace(t.answerContent,{answer:e,imageUrl:r.Z.replace(t.baseUrl,{itemInd:a})})})).join("")}},afterLoad({parameters:e}){this.runFunc("addListeners",{parameters:e}),this.match.rounds[e.roundInd].userAnswer&&this.runFunc("onAnswer",{parameters:e,answer:this.match.rounds[e.roundInd].userAnswer})},addListeners({parameters:e}){document.querySelector("#round").addEventListener("click",(async t=>{t.target.matches("[data-answer]")&&!this.match.rounds[e.roundInd].userAnswer?this.runFunc("onAnswer",{parameters:e,answer:t.target.dataset.answer}):t.target.matches("[data-end-game]")&&this.runFunc("onGameEnd",{parameters:e})}))},async onAnswer({parameters:e,answer:t}){const s=await n.g.getRoundTemplates();this.match.rounds[e.roundInd].userAnswer=t;const a=this.match.rounds[e.roundInd].rightAnswer;t!==a&&[...document.querySelectorAll(".answers__item")].find((e=>e.dataset.answer===t)).classList.add("answers__item_wrong"),[...document.querySelectorAll(".answers__item")].find((e=>e.dataset.answer===a)).classList.add("answers__item_right"),document.querySelector(".answers__list").classList.add("answers__list_answered"),+e.roundInd+1===this.match.rounds.length?document.querySelector(".answers__list").innerHTML+=r.Z.replace(s.resultsContent,{results:s.results[o.Z.getLocale()]}):document.querySelector(".answers__list").innerHTML+=r.Z.replace(s.nextLevelContent,{topic:e.topic,category:e.category,roundInd:+e.roundInd+1,nextLevel:s.nextLevel[o.Z.getLocale()]})},async onGameEnd({parameters:e}){const t=(await n.g.getCategoriesFor(e.topic))[e.category],s=await n.g.getItemsFor(e.topic);this.match.endTime=Date.now();const a=Math.floor(Math.random()*s.length);this.match.imageUrl=r.Z.replace(t.baseUrl,{itemInd:a});let o=JSON.parse(localStorage.getItem("matches"));o||(localStorage.setItem("matches",JSON.stringify([])),o=[]),o.push(this.match),localStorage.setItem("matches",JSON.stringify(o)),this.match=void 0}}})}}]);